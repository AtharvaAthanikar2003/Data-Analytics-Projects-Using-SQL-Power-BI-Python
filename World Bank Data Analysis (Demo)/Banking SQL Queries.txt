-- Show Database Banking_DB
Use Banking_DB
Select * from Banking

-- Easy Level
--Q1. Retrieve all clients from the American region
SELECT * FROM Banking WHERE Nationality = 'American';

--Q2. List client names and estimated income
SELECT Name, Estimated_Income FROM Banking;

--Q3. Find all clients who own at least one property
SELECT Client_ID, Name, Properties_Owned 
FROM Banking 
WHERE Properties_Owned > 0;

--Q4. Show clients who have business lending
SELECT Client_ID, Name 
FROM Banking 
WHERE Business_Lending > 0;

--Q5. Get all clients who joined the bank after 2020
SELECT Client_ID, Name, Joined_Bank 
FROM Banking 
WHERE Joined_Bank >= '2020-01-01';

-- Medium Level
--Q6. Count number of clients per continent (based on Nationality)
SELECT Nationality AS Continent, COUNT(*) AS Total_Clients
FROM Banking
GROUP BY Nationality;

--Q7. Find average estimated income by loyalty classification
SELECT Loyalty_Classification, AVG(Estimated_Income) AS Avg_Income
FROM Banking
GROUP BY Loyalty_Classification;

--Q8. Retrieve clients with credit card balance greater than bank deposits
SELECT Client_ID, Name, Credit_Card_Balance, Bank_Deposits
FROM Banking
WHERE Credit_Card_Balance > Bank_Deposits;

--Q9. List the top 10 highest income clients
SELECT TOP 10 Client_ID, Name, Estimated_Income
FROM Banking
ORDER BY Estimated_Income DESC;

--Q10. Count clients by gender
SELECT GenderId, COUNT(*) AS Count_By_Gender
FROM Banking
GROUP BY GenderId;

-- Hard Level
--Q11. Find clients with both checking and saving accounts but no foreign currency account
SELECT Client_ID, Name
FROM Banking
WHERE Checking_Accounts > 0
  AND Saving_Accounts > 0
  AND Foreign_Currency_Account = 0;

--Q12. Calculate total credit exposure: credit card balance + bank loans
SELECT Client_ID, Name,
       (Credit_Card_Balance + Bank_Loans) AS Total_Credit_Exposure
FROM Banking
ORDER BY Total_Credit_Exposure DESC;

--Q13. Identify clients whose superannuation savings are above the average
SELECT Client_ID, Name, Superannuation_Savings
FROM Banking
WHERE Superannuation_Savings >
      (SELECT AVG(Superannuation_Savings) FROM Banking);

--Q14. Determine the number of clients per age range (0–30, 31–50, 51+)
SELECT
  CASE 
    WHEN Age BETWEEN 0 AND 30 THEN '0-30'
    WHEN Age BETWEEN 31 AND 50 THEN '31-50'
    ELSE '51+' 
  END AS Age_Group,
  COUNT(*) AS Total_Clients
FROM Banking
GROUP BY
  CASE 
    WHEN Age BETWEEN 0 AND 30 THEN '0-30'
    WHEN Age BETWEEN 31 AND 50 THEN '31-50'
    ELSE '51+' 
  END
ORDER BY Age_Group;

--Q15. Get the top 5 clients with highest risk-weighted exposure (risk_weighting × total loans)
SELECT TOP 5 Client_ID, Name,
       (Risk_Weighting * Bank_Loans) AS Weighted_Exposure
FROM Banking
ORDER BY Weighted_Exposure DESC;